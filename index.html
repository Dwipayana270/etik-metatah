<!DOCTYPE html>
<html lang="id" x-data="invitationApp()">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Undangan Metatah — Undangan Online Bali</title>
    <meta name="description"
        content="Undangan Metatah (Potong Gigi) — undangan online bertema Bali, single-file, campuran modern & tradisional." />
    <meta property="og:title" content="Undangan Metatah — Undangan Online Bali" />
    <meta property="og:description" content="Undangan Metatah (Potong Gigi) — undangan online bertema Bali." />
    <meta property="og:image" content="https://picsum.photos/1200/630" />
    <meta name="theme-color" content="#f3f4f6" />
    <link rel="icon" href="https://picsum.photos/32/32" />

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Alpine.js -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>

    <!-- AOS -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet" />
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
        href="https://fonts.googleapis.com/css2?family=Mrs+Saint+Delafield&family=Playfair+Display:wght@400;700&family=Montserrat:wght@300;400;500&display=swap"
        rel="stylesheet" />

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        playfair: ["Playfair Display", "serif"],
                        montserrat: ["Montserrat", "sans-serif"],
                        mrsdelafield: ['"Mrs Saint Delafield"', "cursive"],
                    },
                    colors: {
                        "primary-light": "#f3f4f6",   // gray-100
                        "primary": "#e5e7eb",        // gray-200
                        "secondary": "#6b7280",      // gray-600
                        "secondary-light": "#9ca3af", // gray-400
                        "secondary-dark": "#374151",  // gray-700
                        "text-primary": "#374151",    // gray-700
                        "accent": "rgba(107, 114, 128, 0.2)", // gray-600 @ 0.2
                    },
                },
            },
        };
    </script>

    <style>
        :root {
            /* Theme colors mapped to CSS variables for semantic use */
            --color-primary-light: #f3f4f6; /* gray-100 */
            --color-primary: #e5e7eb;       /* gray-200 */
            --color-secondary: #6b7280;     /* gray-600 */
            --color-secondary-light: #9ca3af; /* gray-400 */
            --color-secondary-dark: #374151; /* gray-700 */
            --color-text-primary: #374151;   /* gray-700 */
            --color-accent: rgba(107, 114, 128, 0.2); /* gray-600 @ 0.2 */

            /* RGB components for alpha compositions */
            --color-primary-light-rgb: 243, 244, 246; /* gray-100 */
            --color-primary-rgb: 229, 231, 235;       /* gray-200 */
            --color-secondary-rgb: 107, 114, 128;     /* gray-600 */
            --color-secondary-light-rgb: 156, 163, 175; /* gray-400 */
            --color-secondary-dark-rgb: 55, 65, 81;   /* gray-700 */
            --color-text-primary-rgb: 55, 65, 81;     /* gray-700 */
            --color-accent-rgb: 107, 114, 128;        /* gray-600 */

            /* Neutrals */
            --color-white: #ffffff;
            --color-white-rgb: 255, 255, 255;
            --color-black-rgb: 0, 0, 0;
        }

        body {
            background-color: var(--color-white);
            background-image: url("https://www.transparenttextures.com/patterns/paper-fibers.png");
            background-size: auto;
            background-attachment: fixed;
            background-repeat: repeat;
            color: var(--color-text-primary);
        }

        .parallax-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }

        .parallax-layer {
            position: absolute;
            width: 100%;
            height: 100%;
        }

        .square {
            position: absolute;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            will-change: transform;
            transition: transform 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .square-left {
            left: -8vw;
        }

        .square-right {
            right: -8vw;
        }

        .back-layer .square {
            width: clamp(180px, 30vw, 400px);
            height: clamp(180px, 30vw, 400px);
            opacity: 0.12;
        }

        .front-layer .square {
            width: clamp(120px, 20vw, 260px);
            height: clamp(120px, 20vw, 260px);
            opacity: 0.15;
            transform: none;
        }

        @media (max-width: 768px) {
            .square-left {
                left: -15vw;
            }

            .square-right {
                right: -15vw;
            }

            .back-layer .square {
                width: clamp(140px, 35vw, 280px);
                height: clamp(140px, 35vw, 280px);
            }

            .front-layer .square {
                width: clamp(90px, 28vw, 200px);
                height: clamp(90px, 28vw, 200px);
            }
        }

        /* Additional styles for content from code A */
        .modal-overlay {
            background: rgba(var(--color-black-rgb), 0.8);
        }

        .countdown-item {
            background: linear-gradient(135deg, var(--color-primary), var(--color-primary-light));
            border-radius: 10px;
            padding: 10px;
            min-width: 72px;
        }

        .nav-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            color: var(--color-text-primary);
            transition: color 0.2s ease;
        }

        .nav-btn:hover {
            color: var(--color-secondary);
        }

        a:focus,
        button:focus,
        input:focus,
        textarea:focus {
            outline: 3px solid rgba(var(--color-accent-rgb), 0.25);
            outline-offset: 2px;
        }

        @media (max-width: 640px) {
            .countdown-item {
                min-width: 64px;
                padding: 8px;
            }
        }

        /* Blur effect when modal is open */
        .blur-content {
            filter: blur(5px);
            pointer-events: none;
        }

        /* Disable scroll */
        .no-scroll {
            overflow: hidden;
        }

        /* Full-width accent transparent section */
        .full-width-accent {
            background-color: var(--color-accent);
            width: 100vw;
            margin-left: calc(-50vw + 50%);
            position: relative;
        }

        /* Fixed curved divider */
        .curved-divider {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100px;
            overflow: hidden;
            transform: translateY(-100%);
        }

        .curved-divider::after {
            content: "";
            border-top-left-radius: 50% 100%;
            border-top-right-radius: 50% 100%;
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            background: var(--color-accent);
            height: 66%;
        }

        /* Add curve at the bottom of the accent section */
        .full-width-accent::after {
            content: "";
            position: absolute;
            left: 0;
            width: 100%;
            height: 100px;
            overflow: hidden;
        }

        .full-width-accent::after::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 200%;
            background: var(--color-primary-light);
            border-radius: 0 0 50% 50%;
        }

        /* Gallery Styles - Fixed for perfect infinite loop */
        .gallery-track {
            display: flex;
            gap: 1rem;
            width: fit-content;
            will-change: transform;
        }

        @keyframes scroll-left {
            0% {
                transform: translateX(0);
            }

            100% {
                transform: translateX(-50%);
            }
        }

        @keyframes scroll-right {
            0% {
                transform: translateX(-50%);
            }

            100% {
                transform: translateX(0);
            }
        }

        .scroll-left {
            animation: scroll-left 80s linear infinite;
        }

        .scroll-right {
            animation: scroll-right 80s linear infinite;
        }

        .fade-left,
        .fade-right {
            position: absolute;
            top: 0;
            width: 80px;
            height: 100%;
            z-index: 20;
            pointer-events: none;
        }

        .fade-left {
            left: 0;
            background: linear-gradient(to right, rgba(var(--color-primary-light-rgb), 0.8), transparent);
        }

        .fade-right {
            right: 0;
            background: linear-gradient(to left, rgba(var(--color-primary-light-rgb), 0.8), transparent);
        }

        /* Lightbox - Fixed styles */
        #lightbox {
            display: none;
        }

        #lightbox.active {
            display: flex;
        }

        .lightbox-nav-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(var(--color-black-rgb), 0.5);
            color: var(--color-white);
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 10;
            transition: background 0.3s;
        }

        .lightbox-nav-btn:hover {
            background: rgba(var(--color-black-rgb), 0.8);
        }

        .lightbox-prev {
            left: 20px;
        }

        .lightbox-next {
            right: 20px;
        }

        /* Comments scroll container */
        .comments-container {
            max-height: 500px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .comments-container::-webkit-scrollbar {
            width: 6px;
        }

        .comments-container::-webkit-scrollbar-track {
            background: rgba(var(--color-primary-rgb), 0.2);
            border-radius: 10px;
        }

        .comments-container::-webkit-scrollbar-thumb {
            background: rgba(var(--color-secondary-rgb), 0.5);
            border-radius: 10px;
        }

        .comments-container::-webkit-scrollbar-thumb:hover {
            background: rgba(var(--color-secondary-rgb), 0.7);
        }

        /* Box styling for Info Acara section */
        .box {
            position: relative;
            background-color: rgba(var(--color-primary-light-rgb), 0.7);
            width: 100%;
            max-width: 600px;
            padding: 5px;
            border: 2px solid var(--color-secondary);
            margin: 0 auto;
        }

        .box:before,
        .box:after {
            content: "•";
            position: absolute;
            width: 14px;
            height: 14px;
            font-size: 14px;
            color: var(--color-secondary);
            border: 2px solid var(--color-secondary);
            line-height: 12px;
            top: 5px;
            text-align: center;
        }

        .box:before {
            left: 5px;
        }

        .box:after {
            right: 5px;
        }

        .box-inner {
            position: relative;
            border: 2px solid var(--color-secondary);
            padding: 40px;
        }

        .box-inner:before,
        .box-inner:after {
            content: "•";
            position: absolute;
            width: 14px;
            height: 14px;
            font-size: 14px;
            color: var(--color-secondary);
            border: 2px solid var(--color-secondary);
            line-height: 12px;
            bottom: -2px;
            text-align: center;
        }

        .box-inner:before {
            left: -2px;
        }

        .box-inner:after {
            right: -2px;
        }

        @media (max-width: 768px) {
            img.h-48 {
                height: 6rem;
            }

            h2 {
                font-size: 1.5rem;
            }

            p {
                font-size: 0.9rem;
            }

            .lightbox-nav-btn {
                width: 40px;
                height: 40px;
            }

            .lightbox-prev {
                left: 10px;
            }

            .lightbox-next {
                right: 10px;
            }

            .comments-container {
                max-height: 400px;
            }

            .box-inner {
                padding: 20px;
            }
        }
    </style>
</head>

<body class="font-montserrat min-h-[400vh] overflow-x-hidden relative text-text-primary"
    :class="{'no-scroll': showModal}">
    <div class="parallax-container">
        <div class="parallax-layer back-layer z-10" data-speed="0.15"></div>
        <div class="parallax-layer front-layer z-20" data-speed="0.2"></div>
    </div>

    <!-- Modal Pembuka -->
    <div x-show="showModal" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-200"
        x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0"
        class="fixed inset-0 z-50 flex items-center justify-center modal-overlay" style="display: none;">
        <div class="bg-white/90 backdrop-blur-[10px] rounded-2xl shadow-2xl p-6 max-w-md w-full mx-4 text-center"
            data-aos="zoom-in">
            <h2 class="text-4xl font-mrsdelafield text-secondary-dark mb-1">
                Om Swastyastu
            </h2>
            <p class="text-gray-600 mb-4">Yth. Bapak/Ibu/Saudara/i</p>

            <div class="flex gap-3 justify-center">
                <button @click="openInvitation()"
                    class="bg-gradient-to-r from-secondary to-secondary-light text-white px-6 py-2 rounded-full font-bold shadow hover:shadow-lg transform hover:scale-105">
                    <i class="far fa-envelope-open mr-2"></i>Buka Undangan
                </button>
            </div>
        </div>
    </div>

    <!-- Audio (start after user interaction) -->
    <audio id="backgroundMusic" loop preload="auto" x-ref="audioPlayer">
        <source
            src="https://undangonlinebali.com/wp-content/uploads/2021/07/GENDING-SEKAR-GADUNG-Saih-Sadi-Gamelan-Selonding-oleh-Komunitas-Selonding-Bali-Aga-mp3cut.net_.mp3"
            type="audio/mp3" />
    </audio>

    <!-- Main Content (will be blurred when modal is open) -->
    <div id="mainContent" :class="{'blur-content': showModal}"
        class="relative z-[10] px-5 py-[120px] max-w-[700px] mx-auto text-center">
        <!-- HERO -->
        <header class="min-h-screen flex ">
            <div class="container mx-auto px-6 text-center">
                <div class="w-full overflow-hidden mb-8">
                    <img src="https://media-public.canva.com/FnqPo/MAEqEXFnqPo/1/tl.png" alt=""
                        class="block w-full h-full object-cover " aria-hidden="true" />
                </div>

                <div data-aos="zoom-in-up" data-aos-duration="900">
                    <h1 class="text-8xl font-mrsdelafield text-secondary-dark">
                        Upacara Metatah
                    </h1>
                    <p class="my-3 text-3xl text-gray-700">
                        Yth. Bapak/Ibu/Saudara/i
                    </p>
                    <p class="mt-2 text-sm text-gray-500 max-w-xl mx-auto">
                        Atas Asung Kertha Wara Nugraha Ida Sang Hyang Widhi Wasa,
                        perkenankan kami mengundang Bapak/Ibu/Saudara/i hadir memberikan
                        doa restu.
                    </p>
                    <div class="mt-6 flex justify-center gap-3">
                        <a href="#info"
                            class="px-6 py-3 bg-gradient-to-r from-secondary to-secondary-light text-white rounded-full font-semibold shadow hover:scale-105 transform">Info
                            Acara</a>
                        <a href="#ucapan"
                            class="px-6 py-3 border border-gray-300 rounded-full text-gray-700 hover:bg-gray-50">Kirim
                            Ucapan</a>
                    </div>
                </div>

                <!-- Bottom section (divider flipped) -->
                <div class="w-full overflow-hidden mt-8">
                    <img src="https://media-public.canva.com/FnqPo/MAEqEXFnqPo/1/tl.png" alt=""
                        class="block w-full h-full object-cover rotate-180" aria-hidden="true" />
                </div>
            </div>
        </header>

        <section id="mempelai" class="pb-16 relative full-width-accent">
            <div class="curved-divider"></div>
            <div class="container mx-auto w-4/5">
                <div class="text-center mb-8" data-aos="fade-up">
                    <h2 class="text-6xl font-mrsdelafield text-secondary-dark">
                        Keluarga Yang Berbahagia
                    </h2>
                    <p class="mt-2 text-gray-600 max-w-2xl mx-auto">
                        Merupakan kehormatan jika Bapak/Ibu/Saudara/i berkenan hadir
                        memberikan doa restu.
                    </p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                    <!-- Card 1 -->
                    <div data-aos="fade-right"
                        class="bg-white/70 backdrop-blur-[10px] rounded-xl shadow-lg overflow-hidden flex flex-col">
                        <img src="https://picsum.photos/400/400" alt="Putri 1"
                            class="aspect-square object-cover w-full" />
                        <div class="p-6 flex-1 flex flex-col justify-between">
                            <div>
                                <h3 class="text-xl font-semibold mb-2 text-secondary-dark font-playfair">
                                    Dewa Ayu Dinda Pradnyadewi
                                </h3>
                                <p class="text-sm text-gray-500">
                                    <strong>Putri dari:</strong><br />I Dewa Nyoman Artawa &amp;
                                    Sang Ayu Putu Kartini
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Card 2 -->
                    <div data-aos="fade-left"
                        class="bg-white/70 backdrop-blur-[10px] rounded-xl shadow-lg overflow-hidden flex flex-col">
                        <img src="https://picsum.photos/400/401" alt="Putra 1"
                            class="aspect-square object-cover w-full" />
                        <div class="p-6 flex-1 flex flex-col justify-between">
                            <div>
                                <h3 class="text-xl font-semibold mb-2 text-secondary-dark font-playfair">
                                    I Dewa Gede Satya Wedana
                                </h3>
                                <p class="text-sm text-gray-500">
                                    <strong>Putra dari:</strong><br />I Dewa Ketut Swabawa &amp;
                                    I Dewa Ayu Sinthya Dewi
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Card 3 -->
                    <div data-aos="fade-right"
                        class="bg-white/70 backdrop-blur-[10px] rounded-xl shadow-lg overflow-hidden flex flex-col">
                        <img src="https://picsum.photos/400/402" alt="Putri 2"
                            class="aspect-square object-cover w-full" />
                        <div class="p-6 flex-1 flex flex-col justify-between">
                            <div>
                                <h3 class="text-xl font-semibold mb-2 text-secondary-dark font-playfair">
                                    Ni Luh Ayu Maharani
                                </h3>
                                <p class="text-sm text-gray-500">
                                    <strong>Putri dari:</strong><br />I Made Sudarma &amp;
                                    Ni Ketut Rahayu
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Card 4 -->
                    <div data-aos="fade-left"
                        class="bg-white/70 backdrop-blur-[10px] rounded-xl shadow-lg overflow-hidden flex flex-col">
                        <img src="https://picsum.photos/400/403" alt="Putra 2"
                            class="aspect-square object-cover w-full" />
                        <div class="p-6 flex-1 flex flex-col justify-between">
                            <div>
                                <h3 class="text-xl font-semibold mb-2 text-secondary-dark font-playfair">
                                    I Gusti Ngurah Arya Pramana
                                </h3>
                                <p class="text-sm text-gray-500">
                                    <strong>Putra dari:</strong><br />I Gusti Made Yasa &amp;
                                    I Gusti Ayu Mirah Dewi
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>


        <!-- INFO ACARA -->
        <section id="info" class="my-6 py-16 bg-primary-light/50">
            <div class="container mx-auto px-6">
                <div class="text-center mb-8" data-aos="fade-up">
                    <h2 class="text-6xl font-mrsdelafield text-secondary-dark">
                        Info Acara
                    </h2>
                    <p class="mt-2 text-gray-600">
                        Detail tanggal, waktu, dan lokasi upacara.
                    </p>
                </div>

                <div class="box" data-aos="zoom-in">
                    <div class="box-inner">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-center mb-8">
                            <div class="p-4">
                                <div class="text-sm text-gray-500">Hari</div>
                                <div class="text-xl font-bold mt-2">Kamis</div>
                            </div>
                            <div class="p-4">
                                <div class="text-sm text-gray-500">Tanggal</div>
                                <div class="text-4xl font-bold text-secondary-dark mt-1">
                                    17
                                </div>
                                <div class="text-sm mt-1">Juli 2025</div>
                            </div>
                            <div class="p-4">
                                <div class="text-sm text-gray-500">Waktu</div>
                                <div class="text-xl font-bold mt-2">10:00 - 16:00 WITA</div>
                            </div>
                        </div>

                        <!-- Countdown -->
                        <div class="text-center mb-8">
                            <h3 class="text-2xl font-semibold mb-4 font-playfair">
                                Hitung Mundur Acara
                            </h3>
                            <div class="flex justify-center gap-4 flex-wrap">
                                <div class="countdown-item text-white text-center">
                                    <div class="text-3xl font-bold" x-text="countdown.days">00</div>
                                    <div class="text-sm">Hari</div>
                                </div>
                                <div class="countdown-item text-white text-center">
                                    <div class="text-3xl font-bold" x-text="countdown.hours">00</div>
                                    <div class="text-sm">Jam</div>
                                </div>
                                <div class="countdown-item text-white text-center">
                                    <div class="text-3xl font-bold" x-text="countdown.minutes">00</div>
                                    <div class="text-sm">Menit</div>
                                </div>
                                <div class="countdown-item text-white text-center">
                                    <div class="text-3xl font-bold" x-text="countdown.seconds">00</div>
                                    <div class="text-sm">Detik</div>
                                </div>
                            </div>
                        </div>

                        <!-- Peta -->
                        <div>
                            <h4 class="text-lg font-semibold text-secondary-dark mb-3 font-playfair">
                                Lokasi
                            </h4>
                            <div class="rounded-xl overflow-hidden shadow">
                                <iframe class="w-full h-64" frameborder="0" loading="lazy"
                                    src="https://www.google.com/maps?q=Dsn%20Br.Sema%20Agung%2C%20Ds.%20Tusan%2C%20Banjarangkan%2C%20Klungkung&output=embed"
                                    referrerpolicy="no-referrer-when-downgrade" aria-label="Peta lokasi"></iframe>
                            </div>
                            <div class="text-center mt-4">
                                <a href="https://www.google.com/maps/search/?api=1&query=Dsn%20Br.Sema%20Agung%2C%20Ds.%20Tusan%2C%20Banjarangkan%2C%20Klungkung"
                                    target="_blank"
                                    class="inline-flex items-center gap-2 px-4 py-2 rounded-full border border-gray-300 hover:bg-gray-50">
                                    <i class="fas fa-map-marker-alt text-secondary"></i> Buka di
                                    Google Maps
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- UCAPAN -->
        <section id="ucapan" class="py-16">
            <div class="container mx-auto px-6 mb-12">
                <div class="text-center mb-8" data-aos="fade-up">
                    <blockquote class="text-xl italic border-l-4 border-primary pl-4 py-2 mx-auto max-w-2xl">
                        "Dengan Yadnya, semoga kami memperoleh sifat-sifat kemuliaan,
                        kejayaan, kekuatan rohani, kekuatan jasmani, kesejahteraan dan
                        perlindungan"
                        <footer class="text-right mt-2 text-gray-600">
                            — (Yajurweda XV.113)
                        </footer>
                    </blockquote>
                </div>

                <div class="max-w-2xl mx-auto bg-white/70 backdrop-blur-[10px] rounded-xl shadow p-6"
                    data-aos="fade-up">
                    <h3 class="text-xl font-semibold mb-4 font-playfair">
                        Kirimkan Ucapan & Doa Restu
                    </h3>
                    <form class="space-y-4" @submit.prevent="submitComment()">
                        <input type="text" x-model="commentForm.name" placeholder="Nama" required
                            class="w-full px-4 py-2 border rounded focus:ring-2 focus:ring-primary" />
                        <textarea x-model="commentForm.message" rows="3" placeholder="Ucapan" required
                            class="w-full px-4 py-2 border rounded focus:ring-2 focus:ring-primary"></textarea>
                        <select x-model="commentForm.attendance" class="w-full px-4 py-2 border rounded">
                            <option value="">Konfirmasi Kehadiran</option>
                            <option value="Hadir">Hadir</option>
                            <option value="Tidak Hadir">Tidak Hadir</option>
                        </select>

                        <div class="flex justify-between items-center">
                            <div class="text-sm text-gray-500">
                                Semua ucapan disimpan di perangkat Anda (localStorage).
                            </div>
                            <div class="flex gap-3">
                                <button type="submit"
                                    class="px-4 py-2 rounded bg-primary text-white font-semibold">
                                    Kirim
                                </button>
                            </div>
                        </div>
                    </form>
                </div>

                <!-- Comments Display -->
                <div class="max-w-2xl mx-auto mt-8" data-aos="fade-up">
                    <h3 class="text-xl font-semibold mb-4 font-playfair text-center">
                        Ucapan & Doa Restu (<span x-text="comments.length">0</span>)
                    </h3>
                    <!-- Scroll container for comments -->
                    <div class="comments-container" :class="{'overflow-y-auto': comments.length > 5}">
                        <div class="space-y-4">
                            <template x-for="comment in comments.slice().reverse()" :key="comment.time">
                                <div class="bg-white/70 backdrop-blur-[10px] rounded-xl shadow p-4">
                                    <div class="text-left">
                                        <div class="mb-2">
                                            <h4 class="font-semibold font-playfair text-secondary-dark"
                                                x-text="comment.name"></h4>
                                        </div>
                                        <p class="text-gray-700 mb-2" x-text="comment.message"></p>
                                        <div class="flex items-center justify-between">
                                            <div class="text-sm">
                                                <span
                                                    :class="comment.attendance === 'Hadir' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'"
                                                    class="px-2 py-1 rounded" x-text="comment.attendance || '—'"></span>
                                            </div>
                                            <div class="text-xs text-gray-500">
                                                <span x-text="new Date(comment.time).toLocaleDateString('id-ID', { 
                                                    day: 'numeric', 
                                                    month: 'long', 
                                                    year: 'numeric' 
                                                })"></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </div>
                    <!-- Scroll indicator when there are more than 5 comments -->
                    <div x-show="comments.length > 5" class="text-center mt-2 text-sm text-gray-500">
                        <i class="fas fa-arrow-down animate-bounce"></i> Scroll untuk melihat lebih banyak
                    </div>
                </div>
            </div>
        </section>

        <!-- GALERI -->
        <section id="galeri" class="full-width-accent pb-12">
            <div class="curved-divider"></div>
            <div class="">
                <div class="text-center mb-6" data-aos="fade-up">
                    <h2 class="text-6xl font-mrsdelafield text-secondary-dark">
                        Galeri
                    </h2>
                    <p class="text-gray-600">Foto-foto keluarga dan persiapan.</p>
                </div>

                <!-- Smooth Scrolling Gallery -->
                <div class="relative overflow-hidden py-16">
                    <div class="fade-left"></div>
                    <div class="fade-right"></div>

                    <!-- Row 1 -->
                    <div class="relative overflow-hidden">
                        <div class="gallery-track scroll-left">
                            <!-- First set of images -->
                            <template x-for="image in galleryImages.slice(0, 6)" :key="image">
                                <img :src="image"
                                    class="h-48 w-auto object-cover rounded-xl cursor-pointer hover:opacity-80 flex-shrink-0"
                                    @click="openLightbox(galleryImages.indexOf(image))" />
                            </template>
                            <!-- Duplicated set for seamless loop -->
                            <template x-for="image in galleryImages.slice(0, 6)" :key="image + '-dup'">
                                <img :src="image"
                                    class="h-48 w-auto object-cover rounded-xl cursor-pointer hover:opacity-80 flex-shrink-0"
                                    @click="openLightbox(galleryImages.indexOf(image))" />
                            </template>
                        </div>
                    </div>

                    <!-- Row 2 (reverse) -->
                    <div class="relative overflow-hidden mt-6">
                        <div class="gallery-track scroll-right">
                            <template x-for="image in galleryImages.slice(6, 12)" :key="image">
                                <img :src="image"
                                    class="h-48 w-auto object-cover rounded-xl cursor-pointer hover:opacity-80 flex-shrink-0"
                                    @click="openLightbox(galleryImages.indexOf(image))" />
                            </template>
                            <!-- Duplicated set for seamless loop -->
                            <template x-for="image in galleryImages.slice(6, 12)" :key="image + '-dup'">
                                <img :src="image"
                                    class="h-48 w-auto object-cover rounded-xl cursor-pointer hover:opacity-80 flex-shrink-0"
                                    @click="openLightbox(galleryImages.indexOf(image))" />
                            </template>
                        </div>
                    </div>
                </div>
            </div>
        </section>


        <!-- STICKY NAV -->
        <nav class="fixed bottom-0 left-0 w-full bg-white/90 backdrop-blur-[10px] shadow-lg z-40">
            <div class="container mx-auto px-6 py-3">
                <div class="flex justify-around">
                    <a href="#info" class="nav-btn"><i class="far fa-calendar-alt"></i><span
                            class="text-xs">Tanggal</span></a>
                    <a href="#galeri" class="nav-btn"><i class="fas fa-image"></i><span
                            class="text-xs">Galeri</span></a>
                    <button @click="toggleAudio()" class="nav-btn" :aria-pressed="isPlaying">
                        <i :class="isPlaying ? 'fas fa-pause' : 'fas fa-music'"></i><span class="text-xs">Music</span>
                    </button>
                </div>
            </div>
        </nav>

        <!-- LIGHTBOX - Fixed -->
        <div x-show="showLightbox" x-transition:enter="transition ease-out duration-300"
            x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100"
            x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100"
            x-transition:leave-end="opacity-0" @click.away="closeLightbox()" @keydown.escape.window="closeLightbox()"
            class="fixed inset-0 z-50 flex items-center justify-center bg-black/80">
            <button @click="closeLightbox()" class="text-white text-2xl absolute top-4 right-4 z-10">
                &times;
            </button>
            <button @click="prevImage()" class="lightbox-nav-btn lightbox-prev">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button @click="nextImage()" class="lightbox-nav-btn lightbox-next">
                <i class="fas fa-chevron-right"></i>
            </button>
            <img :src="galleryImages[currentImageIndex]" alt="Preview" class="rounded-lg max-w-full max-h-full" />
        </div>
    </div>

    <script>
        function invitationApp() {
            return {
                showModal: true,
                isPlaying: false,
                showLightbox: false,
                currentImageIndex: 0,
                countdown: {
                    days: '00',
                    hours: '00',
                    minutes: '00',
                    seconds: '00'
                },
                commentForm: {
                    name: '',
                    message: '',
                    attendance: ''
                },
                comments: [],
                galleryImages: [
                    'https://picsum.photos/800/800?1',
                    'https://picsum.photos/800/800?2',
                    'https://picsum.photos/800/800?3',
                    'https://picsum.photos/800/800?4',
                    'https://picsum.photos/800/800?5',
                    'https://picsum.photos/800/800?6',
                    'https://picsum.photos/800/800?7',
                    'https://picsum.photos/800/800?8',
                    'https://picsum.photos/800/800?9',
                    'https://picsum.photos/800/800?10',
                    'https://picsum.photos/800/800?11',
                    'https://picsum.photos/800/800?12'
                ],

                init() {
                    // Initialize parallax effect
                    this.initParallax();

                    // Initialize AOS
                    this.$nextTick(() => {
                        AOS.init({
                            duration: 900,
                            once: true,
                            offset: 80,
                        });
                    });

                    // Load comments from localStorage
                    this.loadComments();

                    // Start countdown
                    this.updateCountdown();
                    setInterval(() => this.updateCountdown(), 1000);

                    // Handle smooth scrolling
                    this.initSmoothScroll();
                },

                initParallax() {
                    const backLayer = document.querySelector(".back-layer");
                    const frontLayer = document.querySelector(".front-layer");

                    this.createSquare(backLayer, "back", "left", 20);
                    this.createSquare(backLayer, "back", "right", 65);
                    this.createSquare(frontLayer, "front", "left", 45);
                    this.createSquare(frontLayer, "front", "right", 30);

                    const layers = document.querySelectorAll(".parallax-layer");
                    let ticking = false;

                    const updateParallax = () => {
                        const scrollY = window.pageYOffset;
                        layers.forEach((layer) => {
                            const speed = parseFloat(layer.dataset.speed) || 0.5;
                            const yPos = -(scrollY * speed);
                            layer.style.transform = `translateY(${yPos}px)`;
                        });
                        ticking = false;
                    };

                    const requestTick = () => {
                        if (!ticking) {
                            window.requestAnimationFrame(updateParallax);
                            ticking = true;
                        }
                    };

                    window.addEventListener("scroll", requestTick, { passive: true });
                    updateParallax();
                },

                createSquare(layer, type, side, topPos) {
                    const square = document.createElement("div");
                    square.className = `square square-${side}`;
                    if (type === "back") {
                        square.style.backgroundImage = `url('https://media-public.canva.com/3gWYg/MAFB-W3gWYg/1/tl.png')`;
                        square.style.opacity = "0.4";
                        const rotation = side === "left" ? -8 : 8;
                        square.style.transform = `rotate(${rotation}deg)`;
                    } else {
                        square.style.backgroundImage = `url('https://media-public.canva.com/EalrA/MAEchNEalrA/1/tl.png')`;
                        square.style.opacity = "0.9";
                        square.style.transform = "none";
                    }
                    square.style.top = `${topPos}%`;
                    layer.appendChild(square);
                },

                openInvitation() {
                    this.showModal = false;
                    window.scrollTo({ top: 0, behavior: "smooth" });
                },

                toggleAudio() {
                    const audioPlayer = this.$refs.audioPlayer;

                    if (this.isPlaying) {
                        audioPlayer.pause();
                    } else {
                        audioPlayer.play().catch(() => { });
                    }
                    this.isPlaying = !this.isPlaying;
                },

                updateCountdown() {
                    const eventTime = new Date("2025-07-17T10:00:00+08:00").getTime();
                    const now = Date.now();
                    let diff = eventTime - now;

                    if (diff < 0) diff = 0;

                    const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((diff % (1000 * 60)) / 1000);

                    this.countdown = {
                        days: String(days).padStart(2, '0'),
                        hours: String(hours).padStart(2, '0'),
                        minutes: String(minutes).padStart(2, '0'),
                        seconds: String(seconds).padStart(2, '0')
                    };
                },

                submitComment() {
                    if (!this.commentForm.name || !this.commentForm.message) {
                        alert("Mohon isi nama dan ucapan.");
                        return;
                    }

                    const newComment = {
                        name: this.commentForm.name,
                        message: this.commentForm.message,
                        attendance: this.commentForm.attendance,
                        time: new Date().toISOString()
                    };

                    this.comments.push(newComment);
                    this.saveComments();

                    // Reset form
                    this.commentForm = {
                        name: '',
                        message: '',
                        attendance: ''
                    };

                    alert("Terima kasih atas ucapan dan konfirmasi Anda!");
                },

                loadComments() {
                    try {
                        this.comments = JSON.parse(localStorage.getItem("metatah_comments_v1")) || [];
                    } catch (e) {
                        this.comments = [];
                    }
                },

                saveComments() {
                    localStorage.setItem("metatah_comments_v1", JSON.stringify(this.comments));
                },

                openLightbox(index) {
                    this.currentImageIndex = index;
                    this.showLightbox = true;
                    // Prevent body scroll when lightbox is open
                    document.body.style.overflow = 'hidden';
                },

                closeLightbox() {
                    this.showLightbox = false;
                    // Restore body scroll
                    document.body.style.overflow = '';
                },

                nextImage() {
                    this.currentImageIndex = (this.currentImageIndex + 1) % this.galleryImages.length;
                },

                prevImage() {
                    this.currentImageIndex = (this.currentImageIndex - 1 + this.galleryImages.length) % this.galleryImages.length;
                },

                initSmoothScroll() {
                    document.querySelectorAll('a[href^="#"]').forEach((a) => {
                        a.addEventListener("click", (e) => {
                            const id = a.getAttribute("href").slice(1);
                            const el = document.getElementById(id);
                            if (el) {
                                e.preventDefault();
                                const top = el.getBoundingClientRect().top + window.pageYOffset - 90;
                                window.scrollTo({ top, behavior: "smooth" });
                            }
                        });
                    });
                }
            }
        }
    </script>
</body>

</html>
